function Sentence(){this.store={section:document.getElementById("section"),content:document.getElementById("content"),footer:document.getElementById("wrapper-buttons"),contentPosition:null,sentence:null,words:[],clones:[],wordPositions:[],itemsOnBoard:null,wrapper:null,wrapperBack:null,wrapperBackHeight:0,wrapperBackTop:0,nextArr:null,translationSpans:[],menuItems:[]},this.opts={easing:[.645,.045,.355,1],duration:200,valueX:400},this.state={transIn:!1,footerIn:!1,btns:{showTrans:!1,backHome:!1,nextArr:!1},level:"home",a:0,b:0,c:0,pct:[]},this._loadState(),this._begin()}Sentence.prototype={constructor:Sentence,_begin:function(){var t=this.store.content;this.store.contentPosition=t.getBoundingClientRect(),this._attachListeners(),"home"===this.state.level?(this._createMenu(),this.menuIn()):this._newSentence()},_newSentence:function(){this._changeColor(),this._removeHome(),this._toggleFooter(),this._getSentence(),this._createItemsOnBoard(),this._createSentence(),this._createClones(),this._createWrapperBack(),this._createTranslation(),this._createNextArr(),this._newSortable(),this._watchResize(!0),this._saveState(),this._comeIn()},_finishedSentence:function(){var t=this.state.level,e=this.state[t];"home"!==t&&(this._destroySortable(),this.state[t]=e+1,this._saveState(),this.showTrans(),this._toggleItems(),this._toggleNextArr())},nextSentence:function(){var t=this.state.level;if("home"!==t){var e=this,n=this._debounce(function(){e._toggleItems(),e._removeSentence(),e._cleanStore(),e._getSentence(),e._createSentence(),e._createClones(),e._animateWrapperBack(),e._createTranslation(),e._createNextArr(),e._newSortable(),e._watchResize(!0),e._toggleBtn("showTrans",!0),e._comeIn()},300);this._comeOut(n)}},backHome:function(){function t(){function t(){e._destroy(n),e._changeColor(),e._cleanStore(),e._createMenu(),e.menuIn()}e.state.level="home",e._saveState(),e._removeSentence(),e._removeWrapperBack(t)}if("home"!==this.state.level){var e=this,n=this.store.content.firstChild;this._watchResize(!1),this._toggleFooter(),this._comeOut(t)}},_createMenu:function(){var t=this,e=this.store.content,n=document.createElement("div"),s=document.createElement("button");n.className="items center",n.id="menu-home",s.className="btn-menu btn-menu-hidden";var o=s.cloneNode(!0),a=s.cloneNode(!0);this._getLevelsPct(),s.className+=" btn-menu-1",s.id="menuOutA",s.innerHTML='<span>Od podstaw</span><div class="percent">'+this.state.pct[0]+"%</div>",o.className+=" btn-menu-2",o.id="menuOutB",o.innerHTML='<span>Åšrednio-zaawansowane</span><div class="percent">'+this.state.pct[1]+"%</div>",a.className+=" btn-menu-3",a.id="menuOutC",a.innerHTML='<span>Zaawansowane</span><div class="percent">'+this.state.pct[2]+"%</div>",this.store.menuItems=[s,o,a],n.appendChild(s),n.appendChild(o),n.appendChild(a),e.appendChild(n)},_createItemsOnBoard:function(){var t=this.store.content,e=document.createElement("div");e.id="items",e.className="items items-on-board",this.store.itemsOnBoard=e,t.insertBefore(e,t.firstChild)},_createSentence:function(){var t=this.store.sentence,e=t.s,n=t.b;void 0===n&&(n=!1);var s=this.store.content,o=this.store.itemsOnBoard,a=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),c,l,h;for(a.id="wrapper-words",r.className="btn-outer",i.className="btn-word",r.appendChild(i),c=e[0].concat(),c=c.sort(function(){return.5-Math.random()});this._checkSpill(c,e);)c=c.sort(function(){return.5-Math.random()});for(var p=0,u=c.length;u>p;p++)l=r.cloneNode(!0),l.dataset.pos=p+1,l.firstChild.innerHTML=c[p],a.appendChild(l),h=this.store.words.push(l);this.store.wrapper=a,o.appendChild(a)},_createClones:function(){var t=this,e=this.store.wrapper,n=this.store.contentPosition,s=this.store.words,o=this.opts.valueX,a=[],r=[],i,c,l,h,p=document.createElement("div");p.className="clones",p.id="wrapper-clones",function(){for(var t=0,e=s.length;e>t;t++){var c=s[t];l=c.getBoundingClientRect(),a[t]={left:Math.round(l.left-n.left),top:Math.round(l.top-n.top),bottom:Math.round(l.bottom)},h=c.cloneNode(!0),h.className=h.className+" clone",Velocity.hook(h,"translateX",a[t].left+o+"px"),Velocity.hook(h,"translateY",a[t].top+"px"),p.appendChild(h),i=r.push(h)}}(),this.store.clones=r,this.store.wordPositions=a,e.parentNode.appendChild(p)},_createWrapperBack:function(){this._checkBackSize();var t=this,e=this.store.wrapper,n=this.store.wrapperBackHeight,s=this.store.wrapperBackTop,o=document.createElement("div");o.className="wrapper-back",o.style.height=n+"px",o.style.top=s+"px",Velocity.hook(o,"scaleY",0),this.store.wrapperBack=o,e.parentNode.appendChild(o),Velocity(o,{scaleY:[1,0]},{duration:1.5*t.opts.easing,easing:t.opts.easing,queue:!1})},_createTranslation:function(){var t=this.store.wrapperBack,e=this.store.sentence,n=e.t,s=document.createElement("p"),o=n.split(" "),a=[],r,i;s.id="translation",s.className="translation";for(var c=0,l=o.length;l>c;c++)r=document.createElement("span"),r.appendChild(document.createTextNode(o[c])),i=a.push(r),s.appendChild(r),l-1>c&&s.appendChild(document.createTextNode(" "));this.store.translationSpans=a,t.appendChild(s)},_createNextArr:function(){if("home"!==this.state.level){var t=this,e=this.store.itemsOnBoard,n=document.createElement("div"),s=document.createElement("button");n.className="wrapper-next-arr",n.id="wrapper-next-arr",s.className="next-arr",s.id="next-arr",s.type="button",s.innerHTML="&raquo",this.store.nextArr=s,s.addEventListener("click",function o(){t.nextSentence(),s.removeEventListener("click",o,!1)},!1),n.appendChild(s),e.appendChild(n)}},_newSortable:function(){var t=this,e=this.store.wrapper,n;e&&(n=new Sortable(e,{animation:0,onStart:function(e){t._toggleOpacity(e.item,"0.5")},onEnd:function(e){t._toggleOpacity(e.item,"1"),t._checkSentence()}}),this.store.sortable=n)},_removeHome:function(){try{var t=this.store.content,e=document.getElementById("menu-home"),n=e.cloneNode(!0),s=t.replaceChild(n,e),o=t.removeChild(n);s=o=null}catch(a){}},_removeFooter:function(){},_removeWrapperBack:function(t){var e=this,n=this.store.sentence.s[0].length,s=this.store.wrapperBack,o=this._debounce(function(){t()},50);Velocity(s,{scaleY:[0,1],opacity:[0,1]},{duration:1.5*e.opts.duration,easing:e.opts.easing,complete:function(t){t.forEach(function(t,e,n){o()})}})},_removeSentence:function(){var t=document.getElementById("translation"),e=document.getElementById("wrapper-words"),n=document.getElementById("wrapper-clones"),s=document.getElementById("wrapper-next-arr");this._destroy(e),this._destroy(n),this._destroy(t),this._destroy(s)},_destroySortable:function(){var t=this.store.sortable;t.destroy(),this.store.sortable=null},menuIn:function(){for(var t=this,e=this.store.menuItems,n,s=0,o=e.length;o>s;s++)n=e[s],Velocity(n,{opacity:[1,0],translateX:[0,"200px"]},{duration:2*t.opts.duration,easing:t.opts.easing,delay:100*s})},menuOut:function(t){if("home"===this.state.level){var e=this,n=document.querySelectorAll(".btn-menu"),s;this.state.level=t;for(var o=0,a=n.length;a>o;o++)s=n[o],Velocity(s,{opacity:[0,1],translateX:["-200px",0]},{duration:2*e.opts.duration,easing:e.opts.easing,delay:100*o,complete:function(t){t.forEach(function(t,s,o){t===n[a-1]&&e._newSentence()})}})}},animate:function(){var t=this,e=this.store.words,n=this.store.clones,s=this.store.contentPosition,o=this.store.wordPositions,a=[],r=e.length,i,c,l,h,p,u;!function(){for(var t=0;r>t;t++);}(),function(){for(var t=0;r>t;t++)i=e[t].getBoundingClientRect(),a[t]={left:Math.round(i.left-s.left),top:Math.round(i.top-s.top),bottom:Math.round(i.bottom-s.top)}}(),this.store.wordPositions=a,p=this._debounce(function(){for(var e=0;r>e;e++)Velocity(n[e],{translateX:[a[e].left,o[e].left],translateY:[a[e].top,o[e].top]},{duration:t.opts.duration,easing:t.opts.easing,queue:!1})},10),p(),(u=this._debounce(function(){t._animateWrapperBack()},200))()},_animateWrapperBack:function(){var t=this;if(wrapperBack=this.store.wrapperBack,changedWrapperBack=this._checkBackSize(),changedWrapperBack){var e=this.store.wrapperBackHeight,n=this.store.wrapperBackTop;Velocity(wrapperBack,{height:e,top:n},{duration:1.5*t.opts.duration,easing:t.opts.easing,queue:!1})}},showTrans:function(){if(!this.state.transIn&&"home"!==this.state.level){for(var t=this,e=this.store.translationSpans,n,s=0,o=e.length;o>s;s++)n=e[s],Velocity(n,{opacity:[1,0],translateX:[0,"200px"]},{duration:t.opts.duration,easing:t.opts.easing,delay:100*s});this._toggleBtn("showTrans",!1),this.state.transIn=!0}},_toggleFooter:function(){var t=this.state.level,e=this.store.footer;this.state.footerIn?(e.parentNode.className="app-footer",this.state.footerIn=!1):(e.parentNode.className+=" app-footer-sentence",this.state.footerIn=!0),this._toggleBtn("showTrans",this.state.footerIn),this._toggleBtn("backHome",this.state.footerIn)},_toggleBtn:function(t,e){if(e!==this.state.btns[t]){var n=document.getElementById(t),s="btn-footer-hidden";this.state.btns[t]=e,this._toggleClass(n,s)}},_toggleNextArr:function(){if("home"!==this.state.level){var t=this,e=this.store.nextArr;this.state.btns.nextArr?(this.state.btns.nextArr=!1,Velocity(e,{scale:[0,1]},{duration:2*t.opts.duration,easing:t.opts.easing,delay:t.opts.duration,display:"none"})):(this.state.btns.nextArr=!0,Velocity(e,{scale:[1,0]},{duration:2*t.opts.duration,easing:t.opts.easing,delay:t.opts.duration,display:"block"}))}},_comeIn:function(){var t=this,e=this.store.wordPositions,n=this.store.clones,s=this.opts.valueX,o;!function(){for(var a=0,r=n.length;r>a;a++)o=e[a].left,Velocity(n[a],{opacity:1,translateX:[o,o+s]},{duration:t.opts.duration,easing:t.opts.easing,delay:100*a+t.opts.duration,queue:!1})}()},_comeOut:function(t){if("home"!==this.state.level){var e=this,n=this.store.wordPositions,s=this.store.clones,o=this.store.nextArr,a=this.state.transIn,r=this.opts.valueX,i=this.store.wrapper.childNodes,c,l,h,p=this._debounce(function(){t()},50);if(a){var u=this.store.translationSpans;!function(){for(var t=0,n=u.length;n>t;t++)c=u[t],Velocity(c,{opacity:[0,1],translateX:["-200px",0]},{duration:e.opts.duration,easing:e.opts.easing,delay:100*t})}()}this.state.btns.nextArr&&this._toggleNextArr(),function(){for(var t=0,o=i.length;o>t;t++)h=i[t].dataset.pos-1,l=n[h].left,Velocity(s[h],{opacity:[0,1],translateX:[l-r,l]},{duration:e.opts.duration,easing:e.opts.easing,delay:100*t+e.opts.duration,queue:!1,complete:function(t){t.forEach(function(t,e,n){t===s[o-1]&&p()})}})}()}},_changeColor:function(){var t=this.store.section,e=" section-100",n=this.state.level;switch(n){case"a":t.className="section-green"+e;break;case"b":t.className="section-orange"+e;break;case"c":t.className="section-red"+e;break;case"home":t.className="section-dark"+e}},_toggleOpacity:function(t,e){try{var n=t.dataset.pos-1,s=this.store.clones[n];Velocity.hook(s,"opacity",e)}catch(o){}},_toggleItems:function(){var t=this.store.itemsOnBoard;"items items-on-board"===t.className?t.className+=" items-off":t.className="items items-on-board"},_getSentence:function(){try{var t=this.state.level,e=this.state[t],n;switch(t){case"a":n=arrayA(e,!1);break;case"b":n=arrayB(e,!1);break;case"c":n=arrayC(e,!1)}return this.store.sentence=n}catch(s){console.log(s)}},_getLevelsPct:function(){try{var t=this.state,e=arrayA(!1,!0),n=arrayB(!1,!0),s=arrayC(!1,!0),o=Math.round(100*t.a/e),a=Math.round(100*t.b/n),r=Math.round(100*t.c/s);t.pct=[o,a,r]}catch(i){}},_checkSentence:function(){var t=this,e=this.store.sentence,n=e.s,s=this.store.wrapper,o=[],a,r,i;(a=this._debounce(function(){r=s.querySelectorAll(".btn-word"),function(){for(var t=0,e=r.length;e>t;t++)i=o.push(r[t].innerHTML)}(),t._checkSpill(o,n)&&t._finishedSentence(),console.log("check sentence")},200))()},_checkBackSize:function(){try{for(var t=this.store.wordPositions,e=this.store.wrapperBackHeight,n=[],s=[],o,a,r,i,c=0,l=t.length;l>c;c++)o=t[c].top,a=t[c].bottom,n.push(o),s.push(a);if(console.log("check back size"),n.sort(),s.sort(),r=Math.floor(s[s.length-1]-n[0])+6,i=Math.floor(n[0]-3),e!==r)return this.store.wrapperBackHeight=r,this.store.wrapperBackTop=i,!0}catch(h){}},_watchResize:function(t){var e=this,n;t?(n=e._debounce(function(){e.animate()},250),window.addEventListener("resize",n,!1),e.store.resize=n,console.log("watch resize on")):(n=e.store.resize,window.removeEventListener("resize",n,!1),e.store.resize=null,console.log("watch resize off"))},_attachListeners:function(){var t=this;document.addEventListener("click",function e(n){var s=n.target;switch(s.id){case"showTrans":t.showTrans();break;case"backHome":t.backHome();break;case"resetState":t.resetState();break;case"menuOutA":t.menuOut("a");break;case"menuOutB":t.menuOut("b");break;case"menuOutC":t.menuOut("c")}})},_cleanStore:function(){this.store.sentence=this.store.wrapper=this.store.nextArr=this.store.translationSpans=null,this.store.wrapperBackHeight=this.store.wrapperBackTop=0,this.store.words=this.store.clones=this.store.wordPositions=this.store.translationSpans=[],this.state.transIn=this.state.btns.nextArr=!1,console.log("cleaned store")},_saveState:function(){var t=this.state,e=t.level,n=localStorage;n.setItem("level",e),console.log("saved level"),"home"!==e&&(n.setItem(e,t[e]),console.log("saved number"))},_loadState:function(){if(localStorage.length>0){var t=parseInt(localStorage.getItem("a")),e=parseInt(localStorage.getItem("b")),n=parseInt(localStorage.getItem("c"));this.state.level=localStorage.getItem("level"),t>=0&&(this.state.a=t),e>=0&&(this.state.b=e),n>=0&&(this.state.c=n),console.log("state loaded")}},resetState:function(){var t=localStorage;t.length>0&&(t.clear(),document.location.reload())},_debounce:function(t,e,n){var s;return function(){var o=this,a=arguments,r=function(){s=null,n||t.apply(o,a)},i=n&&!s;clearTimeout(s),s=setTimeout(r,e),i&&t.apply(o,a)}},_toggleClass:function(t,e){if(t.classList)t.classList.toggle(e);else{var n=t.className.split(" "),s=n.indexOf(e);s>=0?n.splice(s,1):n.push(e),t.className=n.join(" ")}},_destroy:function(t){try{var e=t.parentNode,n=t.cloneNode(!0),s=e.replaceChild(n,t),o=e.removeChild(n);t=n=s=o=null}catch(a){console.log(a)}},_compareArrays:function(t,e){if(t&&e){if(t.length!==e.length)return!1;for(var n=0,s=t.length;s>n;n++)if(t[n]!==e[n])return!1;return!0}},_checkSpill:function(t,e){var n=this,s=e.every(function(e,s,o){return n._compareArrays(t,e)});return s}};var sentence=new Sentence;